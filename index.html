<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ÙƒØªØ¨ Ø§Ù„Ø£Ø®ÙˆÙŠÙ† </title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, sans-serif; text-align: center; background-color: #f0f4f8; margin: 0; padding: 0; color: #333; }
        header { background: linear-gradient(135deg, #1a73e8, #0d47a1); color: white; padding: 50px 20px 80px 20px; border-radius: 0 0 40px 40px; }
        .search-section { background: white; max-width: 500px; margin: -40px auto 30px auto; padding: 25px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); border-top: 5px solid #ffa000; }
        .search-box { display: flex; gap: 10px; margin-top: 15px; }
        input { flex: 1; padding: 12px; border: 2px solid #e0e0e0; border-radius: 12px; font-size: 16px; outline: none; transition: 0.3s; }
        input:focus { border-color: #1a73e8; }
        .btn-search { padding: 12px 25px; background: #1a73e8; color: white; border: none; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 16px; }
        
        /* ØªØµÙ…ÙŠÙ… Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙˆØµÙ„ */
        #details-output { margin-top: 25px; display: none; text-align: right; }
        .report-header { text-align: center; font-weight: bold; color: #1a73e8; border-bottom: 2px solid #f0f0f0; padding-bottom: 10px; margin-bottom: 15px; font-size: 1.2em; }
        .data-row { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #f9f9f9; font-size: 0.95em; }
        .data-label { font-weight: bold; color: #555; background: #f0f7ff; padding: 2px 8px; border-radius: 5px; }
        .data-value { color: #000; font-weight: 500; }
        
        .error { color: #d32f2f; background: #ffebee; padding: 15px; border-radius: 10px; margin-top: 15px; }
        .loading { color: #1a73e8; font-weight: bold; margin-top: 15px; }
    </style>
</head>
<body>

<header>
    <h1>Ù…ÙƒØªØ¨ Ø§Ù„Ø£Ø®ÙˆÙŠÙ† </h1>
    <p>Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„ÙˆØµÙ„ Ù„Ù…Ø¹Ø±ÙØ© ÙƒØ§ÙØ© ØªÙØ§ØµÙŠÙ„ Ø¬Ù‡Ø§Ø²Ùƒ</p>
</header>

<div class="search-section">
    <h3>ğŸ” Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø¹Ù† Ø§Ù„ÙˆØµÙ„</h3>
    <div class="search-box">
        <input type="text" id="orderID" placeholder="Ø§ÙƒØªØ¨ Ø±Ù‚Ù… Ø§Ù„ÙˆØµÙ„ Ù‡Ù†Ø§ (Ù…Ø«Ù„Ø§Ù‹: 122)">
        <button class="btn-search" onclick="fetchOrderData()">Ø¨Ø­Ø« Ø§Ù„Ø¢Ù†</button>
    </div>
    
    <div id="loading" class="loading" style="display:none;">Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø³Ø¬Ù„...</div>
    <div id="details-output"></div>
</div>

<script>
async function fetchOrderData() {
    const id = document.getElementById('orderID').value.trim();
    const output = document.getElementById('details-output');
    const loading = document.getElementById('loading');
    
    if(!id) { alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„ÙˆØµÙ„"); return; }

    output.style.display = "none";
    loading.style.display = "block";

    try {
        // Ø§Ù„Ø±Ø¨Ø· Ø¨Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù…Ø¹ ÙƒÙˆØ¯ Ù„Ù…Ù†Ø¹ Ø§Ù„ÙƒØ§Ø´ Ù„Ø¶Ù…Ø§Ù† ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙˆØ±Ø§Ù‹
        const sheetUrl = `https://docs.google.com/spreadsheets/d/e/2PACX-1vQkQ-3k94qAWqRRJ0ZKE6jID23TMJRyic8LumQ9-ywVlvET2JcWlP_OJEh2DHlLJaK7q089DHj8ZU5T/pub?output=csv&v=${new Date().getTime()}`;
        const response = await fetch(sheetUrl);
        const csvText = await response.text();
        
        // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ Ù…ØµÙÙˆÙØ©
        const lines = csvText.split('\n').map(line => line.split(','));
        const headers = lines[0]; // Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ù…Ù† Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ø£ÙˆÙ„ ÙÙŠ Ø¬Ø¯ÙˆÙ„Ùƒ
        
        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ù„ÙŠ ÙŠØ­ØªÙˆÙŠ Ø±Ù‚Ù… Ø§Ù„ÙˆØµÙ„ (Ø¨Ø§ÙØªØ±Ø§Ø¶ Ø¥Ù†Ù‡ Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø«Ø§Ù„Ø« Ø­Ø³Ø¨ ØµÙˆØ±ØªÙƒ)
        // Ø±Ø§Ø­ Ù†Ø¨Ø­Ø« Ø¨ÙƒÙ„ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø¯Ù‚Ø©
        const targetRow = lines.find(row => row.some(cell => cell.trim() === id));

        loading.style.display = "none";
        output.style.display = "block";

        if(targetRow) {
            let html = `<div class="report-header">ğŸ“‹ ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØµÙŠØ§Ù†Ø© Ù„Ù„ÙˆØµÙ„ Ø±Ù‚Ù… (${id})</div>`;
            
            targetRow.forEach((value, index) => {
                let label = headers[index] ? headers[index].trim() : `Ù…Ø¹Ù„ÙˆÙ…Ø© ${index+1}`;
                if(value.trim() !== "") { // Ø¹Ø±Ø¶ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù„ÙŠ Ø¨ÙŠÙ‡Ø§ Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø³
                    html += `
                    <div class="data-row">
                        <span class="data-value">${value.trim()}</span>
                        <span class="data-label">${label}</span>
                    </div>`;
                }
            });
            output.innerHTML = html;
        } else {
            output.innerHTML = `<div class="error">âŒ Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø±Ù‚Ù… Ø§Ù„ÙˆØµÙ„ (${id}) ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø³Ø¬Ù„Ø§ØªÙ†Ø§. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø±Ù‚Ù….</div>`;
        }
    } catch(err) {
        loading.style.display = "none";
        output.style.display = "block";
        output.innerHTML = `<div class="error">âš ï¸ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.</div>`;
    }
}
</script>

</body>
</html>
